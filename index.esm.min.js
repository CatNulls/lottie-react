import{jsx as e,jsxs as r,Fragment as t}from"react/jsx-runtime";import{useState as n,useCallback as i,useRef as o,useEffect as a,useMemo as s,forwardRef as l}from"react";import d from"lottie-web";import p from"react-fast-compare";import{EventEmitter as c}from"events";var u,g,h,y;!function(e){e.Svg="svg",e.Html="html",e.Canvas="canvas"}(u||(u={})),function(e){e.Load="load",e.Failure="failure",e.Ready="ready",e.Play="play",e.Pause="pause",e.Stop="stop",e.Freeze="freeze",e.LoopCompleted="loop_completed",e.Complete="complete",e.Frame="frame",e.NewState="new_state"}(g||(g={})),function(e){e.Loading="loading",e.Playing="playing",e.Paused="paused",e.Stopped="stopped",e.Frozen="frozen",e.Failure="failure"}(h||(h={})),function(e){e.Play="play",e.Pause="pause",e.FramesIndicator="framesIndicator",e.ProgressBar="progressBar",e.Loop="loop"}(y||(y={}));class m{subscriptionManager=new c;subscribe=(e,r)=>(this.subscriptionManager.on(String(e),r),()=>this.subscriptionManager.off(String(e),r));addSubscriptions=e=>{const r=[];if(e)for(const t in e)r.push(this.subscribe(t,e[t]));return()=>r.forEach((e=>e()))};notify=(e,r)=>this.subscriptionManager.emit(String(e),r)}const b=e=>"function"==typeof e,f=e=>(r,...t)=>{b(e)&&e((e=>"[lottie-react]"+(void 0!==e?` ${e}`:""))(r),...t)},v={log:f(console.log),error:f(console.error),warn:f(console.warn),info:f(console.info)},w=e=>{const{initialState:r,onChange:t}=e??{};if(!r)throw new Error('Please specify the "options.initialState" when you use the "useLottiePlayerState" hook.');const[i,s]=n(r),l=(e=>{const r=o();return a((()=>{r.current=e})),r.current})(i);return a((()=>{t&&b(t)&&t(l,i)}),[t,i,l]),{previousState:l,state:i,setState:s}},x=({src:e,enableReinitialize:r=!1,...t})=>{const l={enableReinitialize:r,...t},{ref:c,setRef:u}=(e=>{const[r,t]=n(e??null);return{ref:{current:r},setRef:i((e=>{t(e)}),[])}})(),[y,b]=n(null),f=s((()=>new m),[]),{previousState:x,state:k,setState:C}=w({initialState:h.Loading,onChange:(e,r)=>{f.notify(g.NewState,{state:r})}}),S=o(l.initialValues),F=o(void 0),[z,P]=n(l.initialValues?.loop||!1),[L,A]=n(l.initialValues?.autoplay||!1),[R,I]=n(l.initialValues?.segment||void 0),[j,T]=n(null);a((()=>{if(v.log("🪄 Trying to (re)initialize the animation"),C((e=>e===h.Loading?e:h.Loading)),!c?.current)return void v.log("⌛️ The container is not ready yet");y&&(v.log("🗑 Animation already initialized, destroying it"),y.destroy());const r=(t=e)&&"string"==typeof t&&t.endsWith(".json")?{path:t}:t&&"object"==typeof t?{animationData:t}:null;var t;if(!r)return v.log("😥 Animation source is not valid"),f.notify(g.Failure,void 0),void C((e=>e===h.Failure?e:h.Failure));let n;try{n=d.loadAnimation({...r,container:c.current,renderer:"svg",loop:z,autoplay:L,initialSegment:R,assetsPath:S.current?.assetsPath,rendererSettings:S.current?.rendererSettings})}catch(e){return v.warn("⚠️ Error while trying to load animation",e),f.notify(g.Failure,void 0),void C((e=>e===h.Failure?e:h.Failure))}v.log("👌 Animation was initialized",n),b(n);const i=(()=>{const e=[{name:"complete",handler:()=>{C(h.Stopped),f.notify(g.Complete,void 0)}},{name:"loopComplete",handler:()=>{f.notify(g.LoopCompleted,void 0)}},{name:"enterFrame",handler:()=>{n&&f.notify(g.Frame,{currentFrame:n.currentFrame})}},{name:"segmentStart",handler:()=>{}},{name:"config_ready",handler:()=>{}},{name:"data_ready",handler:()=>{f.notify(g.Ready,void 0)}},{name:"data_failed",handler:()=>{C(h.Failure)}},{name:"loaded_images",handler:()=>{}},{name:"DOMLoaded",handler:()=>{C(n?.autoplay?h.Playing:h.Stopped)}},{name:"destroy",handler:()=>{}}].map((e=>{try{n?.addEventListener(e.name,e.handler)}catch(e){}return()=>{try{n?.removeEventListener(e.name,e.handler)}catch(e){}}}));return v.log("👂 Internal listeners were registered"),()=>{e.forEach((e=>e()))}})();return()=>{v.log("🧹 Animation is unloading, cleaning up..."),i(),n.destroy(),b(null)}}),[c.current,e]),a((()=>{y&&r&&!p(S.current,l.initialValues)&&(S.current=l.initialValues,P((e=>{if(S.current?.loop===e)return e;const r=S.current?.loop??!1;return y.loop=r,r})),A((e=>{if(S.current?.autoplay===e)return e;const r=S.current?.autoplay??!1;return y.autoplay=r,r})))}),[y,r,l.initialValues]),a((()=>{if(!f||p(F.current,l.subscriptions))return;F.current=l.subscriptions;const e=f.addSubscriptions(l.subscriptions);return v.log("👂 Consumer's subscriptions were registered"),()=>{v.log("🧹 Unregistering consumer's subscriptions..."),e()}}),[f,l.subscriptions]);const B=i((()=>{y&&(y.play(),C(h.Playing),f.notify(g.Play,void 0))}),[y,f,C]),M=i((()=>{y&&(y.pause(),C(h.Paused),f.notify(g.Pause,void 0))}),[y,f,C]),N=i((()=>{y&&(y.goToAndStop(1),C(h.Stopped),f.notify(g.Stop,void 0))}),[y,f,C]),V=i((()=>{y&&(y.loop=!y.loop,P(y.loop))}),[y]),E=i((e=>{y&&y?.setSpeed(e)}),[y]),W=i(((e,r)=>{if(!y)return;const t=(e=>{const r=/^(([0-9]*[.])?[0-9]+)(%?)$/.exec(String(e));return r?.[1]?{number:Number(r[1]),isPercentage:"%"===r[3]}:null})(e);if(!t)return;const n=t.isPercentage?y.totalFrames*t.number/100:t.number;C((e=>{r||j?r&&j&&T(null):T(e);return r&&(e===h.Playing||j===h.Playing)?(y?.goToAndPlay(n,!0),h.Playing):(y?.goToAndStop(n,!0),e!==h.Stopped?h.Paused:e)}))}),[y,C,j]);return{setContainerRef:u,animationItem:y,state:k,subscribe:f.subscribe,totalFrames:y?.totalFrames??0,loop:z,play:B,pause:M,stop:N,toggleLoop:V,setSpeed:E,seek:W}},k=r=>{const{children:t,...n}=r;return e("div",{...n,style:{position:"relative",width:"100%",height:"100%",minHeight:0,minWidth:0,display:"flex",flexDirection:"column",...n.style},children:t},void 0)},C=l(((r,t)=>{const{children:n,...i}=r;return a((()=>{t||v.warn("😬 Seems like you forgot to pass the `ref` property to the `PlayerContainer` component.")}),[t]),e("div",{...i,style:{display:"flex",flex:1,minHeight:0,minWidth:0,justifyContent:"center",...i.style},ref:t,children:n},void 0)})),S=({size:r})=>e("div",{style:{paddingLeft:r/2,paddingRight:r/2}},void 0),F={container:{display:"flex",background:"rgb(77 77 77)",fontSize:12,fontWeight:"500",color:"white",justifyContent:"center",borderRadius:3},frameSpan:{padding:"2px 2px",minWidth:30,height:25,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"},delimiterSpan:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"}},z=({subscribe:t,totalFrames:n,decimals:l})=>{const d=o(null),p=s((()=>l??0),[l]),c=i((e=>15+7*e),[]);return a((()=>{if(t)return t(g.Frame,(({currentFrame:e})=>{d.current&&(d.current.innerText=e?.toFixed(p))}))}),[p,t]),r("div",{style:F.container,children:[e("span",{ref:d,style:{...F.frameSpan,minWidth:c(String(n).length+(p?p+1:0))},children:"0"},void 0),e("span",{style:F.delimiterSpan,children:"/"},void 0),e("span",{style:{...F.frameSpan,minWidth:c(String(n).length)},children:n},void 0)]},void 0)};function P(e,r){void 0===r&&(r={});var t=r.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}P("input[type=range].player-controls-progress-bar{--range:calc(var(--max) - var(--min));--ratio:calc((var(--value) - var(--min))/var(--range));--sx:calc(1em + var(--ratio)*(100% - 2em));-webkit-appearance:none;background:none;margin:0;padding:0;width:100%}input[type=range].player-controls-progress-bar:disabled{cursor:default}input[type=range].player-controls-progress-bar:focus{outline:none}input[type=range].player-controls-progress-bar::-webkit-slider-runnable-track{background:linear-gradient(#00d1c1,#00d1c1) 0 /var(--sx) 100% no-repeat,#4d4d4d;border:0 solid transparent;border-radius:5px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0);cursor:pointer;height:10px;width:100%}input[type=range].player-controls-progress-bar:active::-webkit-slider-runnable-track,input[type=range].player-controls-progress-bar:hover::-webkit-slider-runnable-track{background:linear-gradient(#00ebd9,#00ebd9) 0 /var(--sx) 100% no-repeat,#5a5a5a}input[type=range].player-controls-progress-bar::-webkit-slider-thumb{-webkit-appearance:none;background:#007a87;border:0 solid transparent;border-radius:10px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0);cursor:pointer;height:20px;margin-top:-5px;width:20px}input[type=range].player-controls-progress-bar::-webkit-slider-thumb:hover{background:#0091a1}input[type=range].player-controls-progress-bar::-moz-range-track{background:linear-gradient(#00d1c1,#00d1c1) 0 /var(--sx) 100% no-repeat,#4d4d4d;border:0 solid transparent;border-radius:5px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0);cursor:pointer;height:10px;width:100%}input[type=range].player-controls-progress-bar:active::-moz-range-track,input[type=range].player-controls-progress-bar:hover::-moz-range-track{background:linear-gradient(#00ebd9,#00ebd9) 0 /var(--sx) 100% no-repeat,#5a5a5a}input[type=range].player-controls-progress-bar::-moz-range-progress{cursor:pointer}input[type=range].player-controls-progress-bar::-moz-range-thumb{background:#007a87;border:0 solid transparent;border-radius:10px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0);cursor:pointer;height:20px;width:20px}input[type=range].player-controls-progress-bar::-moz-range-thumb:hover{background:#0091a1}input[type=range].player-controls-progress-bar::-ms-track{background:transparent;border-color:transparent;border-width:20px 0;color:transparent;cursor:pointer;height:10px;width:100%}input[type=range].player-controls-progress-bar::-ms-fill-lower{background:#00b8a9;border:0 solid transparent;border-radius:10px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0)}input[type=range].player-controls-progress-bar:focus::-ms-fill-lower{background:#00d1c1}input[type=range].player-controls-progress-bar::-ms-fill-upper{background:#00d1c1;border:0 solid transparent;border-radius:10px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0)}input[type=range].player-controls-progress-bar:focus::-ms-fill-upper{background:#00ebd9}input[type=range].player-controls-progress-bar::-ms-thumb{background:#007a87;border:0 solid transparent;border-radius:10px;box-shadow:0 0 0 transparent,0 0 0 hsla(0,0%,5%,0);cursor:pointer;height:20px;width:20px}");const L=r=>{const t=o(null),{totalFrames:n,subscribe:i,disabled:s,onChange:l}=r,d=n??0,p=b(l);a((()=>{if(i)return i(g.Frame,(({currentFrame:e})=>{t.current&&(t.current.value=String(e),t.current.style.setProperty("--value",`${e}`))}))}),[i]);return e("div",{style:{flex:1},children:e("input",{ref:t,disabled:s||!d,className:"player-controls-progress-bar",type:"range",style:{"--min":0,"--max":d},onChange:e=>{const r=Number(e.target.value);p&&l?.(r)},onMouseUp:()=>{p&&t.current&&l?.(Number(t.current.value),!0)},min:0,max:d,step:.001},void 0)},void 0)},A="#00d1c1",R="#ffffff",I=({children:r,onClick:t})=>e("button",{style:{background:"rgb(77 77 77)",display:"flex",justifyContent:"center",alignItems:"center",padding:5,width:30,height:25,borderRadius:3,cursor:"pointer",border:0},onClick:t,children:r},void 0),j=({isOn:r,onClick:t})=>e(I,{onClick:t,children:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",children:e("path",{d:"M2 12c0 .999.381 1.902.989 2.604l-1.098.732-.587.392c-.814-1.025-1.304-2.318-1.304-3.728 0-3.313 2.687-6 6-6h9v-3l6 4-6 4v-3h-9c-2.206 0-4 1.794-4 4zm20.696-3.728l-.587.392-1.098.732c.608.702.989 1.605.989 2.604 0 2.206-1.795 4-4 4h-9v-3l-6 4 6 4v-3h9c3.313 0 6-2.687 6-6 0-1.41-.489-2.703-1.304-3.728z",fill:r?A:"#ffffff"},void 0)},void 0)},void 0),T=({onClick:r})=>e(I,{onClick:r,children:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",children:e("path",{d:"M10 24h-6v-24h6v24zm10-24h-6v24h6v-24z",fill:R},void 0)},void 0)},void 0),B=({onClick:r})=>e(I,{onClick:r,children:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",children:e("path",{d:"M2 24v-24l20 12-20 12z",fill:R},void 0)},void 0)},void 0),M=n=>{const{show:o,elements:a,state:s,totalFrames:l,loop:d,play:p,pause:c,seek:u,toggleLoop:g,subscribe:m}=n,b=i((e=>!a||!Array.isArray(a)||a.includes(e)),[a]);return o?r("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10},children:[b(y.Play)&&s!==h.Playing&&r(t,{children:[e(B,{onClick:p},void 0),e(S,{size:10},void 0)]},void 0),b(y.Pause)&&s===h.Playing&&r(t,{children:[e(T,{onClick:c},void 0),e(S,{size:10},void 0)]},void 0),b(y.FramesIndicator)&&r(t,{children:[e(z,{subscribe:m,totalFrames:l||0,decimals:0},void 0),e(S,{size:10},void 0)]},void 0),b(y.ProgressBar)&&r(t,{children:[e(L,{subscribe:m,totalFrames:l,onChange:(e,r)=>{u(e,!!r)}},void 0),e(S,{size:10},void 0)]},void 0),b(y.Loop)&&e(j,{isOn:d,onClick:g},void 0)]},void 0):null},N=({children:r,style:t,...n})=>e("div",{...n,style:{position:"absolute",display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,122,135,0.7)",zIndex:1,...t},children:r},void 0),V=({show:r,Component:t,Content:n})=>r?t||e(N,{children:n||"Couldn't load the animation"},void 0):null;P(".player-loading-spinner{display:inline-block;height:80px;position:relative;width:80px}.player-loading-spinner div{-webkit-animation:player-loading-spinner-animation 1s cubic-bezier(0,.2,.8,1) infinite;animation:player-loading-spinner-animation 1s cubic-bezier(0,.2,.8,1) infinite;border:4px solid #fff;border-radius:50%;opacity:1;position:absolute}.player-loading-spinner div:nth-child(2){-webkit-animation-delay:-.5s;animation-delay:-.5s}@-webkit-keyframes player-loading-spinner-animation{0%{height:0;left:45%;opacity:1;top:45%;width:0}to{height:90%;left:0;opacity:0;top:0;width:90%}}@keyframes player-loading-spinner-animation{0%{height:0;left:45%;opacity:1;top:45%;width:0}to{height:90%;left:0;opacity:0;top:0;width:90%}}");const E=({show:r,Component:t,Content:n,color:i="#FFFFFF",size:o=80})=>{if(!r)return null;if(t)return t;const a=[...Array(2).keys()].map(((r,t)=>e("div",{style:{borderColor:`${i}`,borderWidth:.05*o}},t)));return e(N,{children:n||e("div",{className:"player-loading-spinner",style:{width:o,height:o},children:a},void 0)},void 0)},W=l(((t,n)=>{const{src:i,initialValues:o,enableReinitialize:a,controls:s,subscriptions:l,LoadingOverlay:d,FailureOverlay:p,LoadingOverlayContent:c,FailureOverlayContent:u}=t,{setContainerRef:g,state:y,totalFrames:m,loop:b,play:f,pause:v,toggleLoop:w,seek:S,subscribe:F}=x({src:i,initialValues:o,enableReinitialize:a,subscriptions:l});return r(k,{children:[e(E,{show:y===h.Loading,Component:d,Content:c},void 0),e(V,{show:y===h.Failure,Component:p,Content:u},void 0),e(C,{ref:g},void 0),e(M,{show:y!==h.Loading&&y!==h.Failure&&!!s,elements:Array.isArray(s)?s:void 0,state:y,totalFrames:m,loop:b,play:f,pause:v,seek:S,toggleLoop:w,subscribe:F},void 0)]},void 0)}));export{u as AnimationRenderer,W as Lottie,h as LottieState,g as LottieSubscription,k as PlayerContainer,M as PlayerControls,y as PlayerControlsElement,C as PlayerDisplay,W as default,x as useLottie};
